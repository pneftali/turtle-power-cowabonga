(function(){var f=1;$("#winner-content-back-btn").on("click",function(){e($(this).data("start"),$(this).data("paging"))});$("#winner-content-next-btn").on("click",function(){e($(this).data("start"),$(this).data("paging"))});$("#winner-pagination").delegate("a","click",function(){e(parseInt(this.id),parseInt($(this).data("paging")))});var k=Math.ceil(totalMsgCount/6);e(0,1);function e(q,o){var n=new Array("#B7B4FF","#CFE3FF","#FCF49C","#A2FAF6","#F297B3","#B8FFB6","#FFFFFF","#FFFFFF");var p="";if(q>=0){$.ajax({url:"/profile/fetch-messages",type:"GET",dataType:"json",data:"start="+q+"&employee_code="+employee_code,success:function(u){if(u.length>0){c();l(parseInt(q),parseInt(o));var t=1;var r="";var v="";for(var s in u){colorkey=Math.floor(Math.random()*n.length);if(u[s].message.length>25){v=u[s].message.substr(0,30)+"..."}else{v=u[s].message}r+="	<div class='msg-small' style='background:"+n[colorkey]+"'>";r+="		<img style='margin-right: 5px; vertical-align: bottom; position:absolute; top:-25px;' src='/images/pin.png' />";r+="		<div>";if(u[s].anonymous>0){r+="			<div>";r+="				<span style='display: block; font-size: 13px; color: #9C4706;' class='malgunbd'>Anonymous</span>";r+="				<span class='malgunbd date-txt'>"+u[s].pretty_date_posted+"</span>";r+="			</div>"}else{r+="			<img style='margin-right: 5px; vertical-align: bottom; float: left;' src='"+u[s].avatar_path+"' />";r+="			<div>";r+="				<span style='display: block; font-size: 13px; color: #9C4706;' class='malgunbd'>"+u[s].employee_code_from_name+"</span>";r+="				<span class='malgunbd date-txt'>"+u[s].pretty_date_posted+"</span>";r+="			</div>"}r+="		</div>";r+="		<div class='profile-message-div malgunbd' data-messageID='"+u[s].id+"'>"+v+"</div>";r+="	</div>";r+="	<div class='profile-message-big malgunbd' style='background:"+n[colorkey]+"'>";if(u[s].anonymous>0){r+="		<div>";r+="			<span style='font-size: 13px; margin-bottom: 15px; color: #9C4706;' class='malgunbd'>Anonymous</span>";r+="			<span class='malgunbd date-txt'>"+u[s].pretty_date_posted+"</span>";r+="		</div>"}else{r+="		<img style='margin-right: 5px; vertical-align: bottom; float: left;' src='"+u[s].avatar_path+"' />";r+="		<div>";r+="			<span style='font-size: 13px; margin-bottom: 15px; color: #9C4706;' class='malgunbd'>"+u[s].employee_code_from_name+"</span>";r+="			<span class='malgunbd date-txt'>"+u[s].pretty_date_posted+"</span>";r+="		</div>"}r+=u[s].message;r+="	</div>";$("#winner_box_"+t++).html(r);r=""}if(u.length>0){$("#winner-content-back-btn").data("start",q-6);$("#winner-content-next-btn").data("start",q+6);$("#winner-content-back-btn").data("paging",o-1);$("#winner-content-next-btn").data("paging",o+1)}}else{if(totalMsgCount>0){e(0,1)}}},error:function(r,t,s){}})}else{}}function l(t,r){var q="";var o=1;var s=0;var p=1;var n=k-1;if(k<=5){b(r)}else{if(r>=5&&r<n){h(r,t)}else{if(r==k||r==n){g(r,t)}else{a(r)}}}}function b(p){var q=0;var o="";for(var n=1;n<=k;n++){if(n==p){o+="<li id='selected'><a id="+q+" data-paging='"+n+"' href='javascript:void(0)'>"+n+"</a></li>"}else{o+="<li><a id="+q+" data-paging='"+n+"' href='javascript:void(0)'>"+n+"</a></li>"}q+=6}$("#winner-pagination ul").html(o)}function a(p){var r=0;var q=(k*6)-6;var o="";for(var n=1;n<=k;n++){if(n%6){if(n==p){o+="<li id='selected'><a id="+r+" data-paging='"+n+"' href='javascript:void(0)'>"+n+"</a></li>"}else{o+="<li><a id="+r+" data-paging='"+n+"' href='javascript:void(0)'>"+n+"</a></li>"}}else{o+="<li><span id='paging-more'>...</span></li>";o+="<li><a id="+q+" data-paging='"+k+"' href='javascript:void(0)'>"+k+"</a></li>";break}r+=6}$("#winner-pagination ul").html(o)}function h(t,u){var r="";r+="<li><a id="+0+" data-paging='"+1+"' href='javascript:void(0)'>"+1+"</a></li>";r+="<li><span class='paging-more'>...</span></li>";var n=u-6;var q=totalMsgCount-6;var s=t-1;var p=t+1;for(var o=s;o<=p;o++){if(o==t){r+="<li id='selected'><a id="+n+" data-paging='"+o+"' href='javascript:void(0)'>"+o+"</a></li>"}else{r+="<li><a id="+n+" data-paging='"+o+"' href='javascript:void(0)'>"+o+"</a></li>"}n+=6}r+="<li><span id='paging-more'>...</span></li>";r+="<li><a class="+q+" data-paging='"+k+"' href='javascript:void(0)'>"+k+"</a></li>";$("#winner-pagination ul").html(r)}function g(r,s){var q="";q+="<li><a id="+0+" data-paging='"+1+"' href='javascript:void(0)'>"+1+"</a></li>";q+="<li><span class='paging-more'>...</span></li>";var o=(k*6)-30;var t=k-4;var n=t;for(var p=k;p>=t;p--,n++){if(n==r){q+="<li id='selected'><a id="+o+" data-paging='"+n+"' href='javascript:void(0)'>"+n+"</a></li>"}else{q+="<li><a id="+o+" data-paging='"+n+"' href='javascript:void(0)'>"+n+"</a></li>"}o+=6}$("#winner-pagination ul").html(q)}function c(){for(var n=1;n<7;n++){$("#winner_box_"+n).html("")}}var d;var i;var j="small";$(".winner-notes div").hover(function(){$("#"+$(this).attr("id")+" .profile-message-big").show();$(this).css({cursor:"pointer"})},function(){$("#"+$(this).attr("id")+" .profile-message-big").hide()});function m(p){var o=$(p+" .profile-message-div").data("messageid");var n="";$.ajax({url:"/profile/fetch-single-message",type:"GET",dataType:"json",data:"msg_id="+o,beforeSend:function(){$(p).html("<div style='height:100px; position: relative;'><img style='position: absolute; top: 50%; left: 38%;' src='/images/loader/loading.gif' /></div>")},success:function(q){n+="<div style='font-family: arial; font-size: 15px; margin-bottom: 5px; color: #9C4706;'>";n+="<img style='margin-right: 5px; vertical-align: bottom;' src='"+q.avatar_path+"' />";n+=q.employee_code_from_name+"</div>";n+="<div style='overflow-y: scroll; height: 200px; padding:10px; -webkit-transform: (1,1)'>"+q.message+"</div>";$(p).html(n)},error:function(q,s,r){}})}$("#open-feedback").on("click",function(){$(this).hide();$("#feedback-box").show("slide",{direction:"right"},500)});$("#close-feedback").on("click",function(){$("#feedback-box").hide("slide",{direction:"right"},500,function(){$("#open-feedback").show();$("#feed-send-done").hide();$("#feed-send-btn").show()})});$("#feed-send-btn").on("click",function(){var n=$.trim($("#feedback-textarea").val());if(n===""){return false}$.ajax({url:"/index/send-feedback",type:"POST",dataType:"JSON",data:{msg:n},beforeSend:function(){$("#feed-send-btn").hide();$("#feed-send-loading").show()},success:function(o){$("#feed-send-loading").hide();$("#feed-send-done").show();$("#feedback-textarea").val("")}})})}());